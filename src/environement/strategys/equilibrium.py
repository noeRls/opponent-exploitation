from ..Strategy import Strategy
import numpy as np


class EquilibriumStrategy(Strategy):
    def get_name(self):
        return "Equilibrium"

    def get_play(self):
        equilibrium = self.agent.compute_equilibrium()
        summ = equilibrium.sum()
        if (summ != 1 and abs(summ - 1) < 0.0001):
            equilibrium /= equilibrium.sum(axis=0,keepdims=1)
        action = np.random.choice(
            [i for i in range(len(equilibrium))], p=equilibrium)
        return self.env.transform_action_to_enum(action)
