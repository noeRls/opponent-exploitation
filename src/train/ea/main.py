from src.train.ea.Individual import Individual
from src.environement.Strategy import Strategy
from .play_against import play_against
from src.environement.Kuhn.strategy.all_strategy import ALL_KUHN_STRATEGY
from src.environement.Kuhn.KuhnEnv import KuhnEnv
from typing import List
from .Individual import Individual

def main():
    env = KuhnEnv()
    individuals: List[Individual] = []
    for S in ALL_KUHN_STRATEGY:
        individuals.append(Individual(S(env)))

    for x in range(len(individuals)):
        i1 = individuals[x]
        for y in range(x + 1, len(individuals)):
            i2 = individuals[y]
            r1, r2 = play_against(env, i1.startegy, i2.startegy)
            if r1 > r2:
                i1.register_win(i2)
            else:
                i2.register_win(i1)
            print(f'Game: "{i1.startegy.get_name()}"={r1} "{i2.startegy.get_name()}"={r2}')
    for individual in individuals:
        individual.compute_fitness()
        print(f'Fitness "{individual.startegy.get_name()}"={individual.fitness}')
